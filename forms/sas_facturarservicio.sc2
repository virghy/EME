*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="sas_facturarservicio.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
#INCLUDE "..\include\tastrade.h"

DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Cursor1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor2" UniqueID="" Timestamp="" />

	DataSource = .NULL.
	Height = 320
	InitialSelectedAlias = "vt_emision"
	Left = 533
	Name = "Dataenvironment"
	Top = 138
	Width = 520

	ADD OBJECT 'Cursor1' AS cursor WITH ;
		Alias = "sas_ccontratos", ;
		CursorSource = "sas_ccontratos", ;
		Database = ..\data\datos.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor1", ;
		NoDataOnLoad = .T., ;
		Top = 20, ;
		Width = 136
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor2' AS cursor WITH ;
		Alias = "vt_emision", ;
		CursorSource = "vt_emision", ;
		Database = ..\data\datos.dbc, ;
		Height = 193, ;
		Left = 290, ;
		Name = "Cursor2", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

ENDDEFINE

DEFINE CLASS tsbaseform12 AS tsbaseform OF "..\libs\tsbase.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Tstextbox1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tscommandbutton1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Idproducto1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cobrador" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Contrato" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtCantidad" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel15" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtTotales" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtPaciente" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel13" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel12" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Producto" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tscommandbutton2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grdSas_ctiposeguro" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grdSas_ctiposeguro.Column1.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grdSas_ctiposeguro.Column1.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grdSas_ctiposeguro.Column2.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grdSas_ctiposeguro.Column2.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grdSas_ctiposeguro.Column4.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grdSas_ctiposeguro.Column4.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grdSas_ctiposeguro.Column3.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grdSas_ctiposeguro.Column3.Tscheckbox1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grdSas_ctiposeguro.Column5.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grdSas_ctiposeguro.Column5.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grdSas_ctiposeguro.Column6.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grdSas_ctiposeguro.Column6.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cboTipo" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cboCiclo" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="dFecha" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel9" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="hFecha" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cbocobrador1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tipo" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel10" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel11" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtNroContrato" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Olecontrol1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="nom_vendedor" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtNroServicio" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cbovendedor1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="OpcionImpresion" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel14" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel16" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="hFechaAlta" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel17" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="hFechaBaja" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel18" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel19" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtAño" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtMes" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtIdEmision" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel20" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tstextbox3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel21" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Ts3dshape1" UniqueID="" Timestamp="" />

	auditmarcahora = Audit_Fecha
	auditusuario = Audit_Usuario
	campoempresa = IdEmpresa
	campos = IdEmision
	Caption = "Factura Servicio"
	DataSession = 2
	detalle = .T.
	DoCreate = .T.
	Height = 572
	idobjeto = 1184
	Name = "Tsbaseform12"
	tabla1 = vt_Emision
	valores = newid('vt_Emision')
	Width = 841
	lblRequerido.Name = "lblRequerido"
	lblRequerido.TabIndex = 23

	ADD OBJECT 'cboCiclo' AS cbocondventa WITH ;
		cmdsql = Select Ciclo,IdCiclo from sas_CicloFacturacion where idempresa = ?oApp.Empresa union Select '(Todos)' as Ciclo,'-1' as IdCiclo order by 1 , ;
		ControlSource = "", ;
		cursor = cCiclo, ;
		Height = 22, ;
		Left = 144, ;
		Name = "cboCiclo", ;
		TabIndex = 6, ;
		Top = 109, ;
		Width = 156
		*< END OBJECT: ClassLib="..\libs\futura.vcx" BaseClass="combobox" />

	ADD OBJECT 'Cbocobrador1' AS idvendedor WITH ;
		datoayuda = Cobrador, ;
		Height = 23, ;
		indice = Idcobrador, ;
		Left = 144, ;
		Name = "Cbocobrador1", ;
		objeto = this.parent.cobrador, ;
		TabIndex = 4, ;
		tabla = vt_Cobradores a, bs_Personas b, ;
		Top = 84, ;
		Width = 42, ;
		ZOrderSet = 23
		*< END OBJECT: ClassLib="..\libs\futura.vcx" BaseClass="textbox" />

	ADD OBJECT 'cboTipo' AS cbocondventa WITH ;
		cmdsql = Select TipoCobertura, IdTipoCobertura from sas_TipoCobertura where IdEmpresa=?oApp.Empresa union Select '(Todos)' as TipoCobertura,'-1' as IdtipoCobertura order by 1, ;
		ControlSource = "", ;
		cursor = xcTc, ;
		Left = 396, ;
		Name = "cboTipo", ;
		TabIndex = 7, ;
		Top = 109, ;
		Width = 156
		*< END OBJECT: ClassLib="..\libs\futura.vcx" BaseClass="combobox" />

	ADD OBJECT 'Cbovendedor1' AS campo_clave WITH ;
		condicionextra = v.idempresa=?oapp.empresa and v.idpersona=p.idpersona, ;
		datoayuda = Vendedor, ;
		FontBold = .F., ;
		Height = 22, ;
		indice = idvendedor, ;
		Left = 396, ;
		MaxLength = 6, ;
		mensajeerror = No se encuentra el Empleado espesificado, ;
		Name = "Cbovendedor1", ;
		objeto = this.parent.nom_vendedor, ;
		origen = R, ;
		requerido = .F., ;
		retayuda = idvendedor, ;
		retorna = rtrim(p.nombre)+' '+rtrim(apellido), ;
		TabIndex = 5, ;
		tabla = vt_vendedores v,bs_personas p, ;
		Top = 84, ;
		Width = 42, ;
		ZOrderSet = 33
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'Cobrador' AS tstextbox WITH ;
		Comment = "", ;
		editable = .F., ;
		Enabled = .F., ;
		Height = 23, ;
		Left = 187, ;
		Name = "Cobrador", ;
		TabIndex = 41, ;
		Top = 84, ;
		Width = 149, ;
		ZOrderSet = 4
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'Contrato' AS tstextbox WITH ;
		Comment = "", ;
		editable = .F., ;
		Enabled = .F., ;
		Height = 22, ;
		Left = 218, ;
		MaxLength = 50, ;
		Name = "Contrato", ;
		requerido = .T., ;
		TabIndex = 42, ;
		Top = 133, ;
		Width = 334, ;
		ZOrderSet = 6
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'dFecha' AS tstextbox WITH ;
		Alignment = 3, ;
		Height = 21, ;
		Left = 144, ;
		Name = "dFecha", ;
		TabIndex = 13, ;
		Top = 235, ;
		Value = ({  /  /  }), ;
		Width = 156
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'grdSas_ctiposeguro' AS tsgrid WITH ;
		cfieldtosum = Importe,Deuda, ;
		ColumnCount = 6, ;
		FontSize = 8, ;
		Height = 216, ;
		Left = 24, ;
		Name = "grdSas_ctiposeguro", ;
		Panel = 1, ;
		ReadOnly = .F., ;
		RecordSource = "", ;
		RecordSourceType = 1, ;
		RowHeight = 17, ;
		TabIndex = 20, ;
		titulo = Lista de Clientes, ;
		Top = 327, ;
		Width = 513, ;
		Column1.ControlSource = "", ;
		Column1.FontSize = 8, ;
		Column1.Name = "Column1", ;
		Column1.ReadOnly = .T., ;
		Column1.Visible = .T., ;
		Column1.Width = 57, ;
		Column2.ControlSource = "", ;
		Column2.FontSize = 8, ;
		Column2.Name = "Column2", ;
		Column2.ReadOnly = .T., ;
		Column2.Visible = .T., ;
		Column2.Width = 208, ;
		Column3.ColumnOrder = 4, ;
		Column3.ControlSource = "", ;
		Column3.FontSize = 8, ;
		Column3.InputMask = "999,999,999", ;
		Column3.Name = "Column4", ;
		Column3.ReadOnly = .T., ;
		Column3.Visible = .T., ;
		Column3.Width = 88, ;
		Column4.ColumnOrder = 3, ;
		Column4.ControlSource = "", ;
		Column4.FontSize = 8, ;
		Column4.Name = "Column3", ;
		Column4.ReadOnly = .F., ;
		Column4.Sparse = .F., ;
		Column4.Visible = .T., ;
		Column4.Width = 43, ;
		Column5.ControlSource = "", ;
		Column5.FontSize = 8, ;
		Column5.InputMask = "999,999,999", ;
		Column5.Name = "Column5", ;
		Column5.ReadOnly = .F., ;
		Column5.Width = 91, ;
		Column6.ControlSource = "", ;
		Column6.FontSize = 8, ;
		Column6.InputMask = "999,999,999", ;
		Column6.Name = "Column6", ;
		Column6.ReadOnly = .F., ;
		Column6.Width = 86
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="grid" />

	ADD OBJECT 'grdSas_ctiposeguro.Column1.Header1' AS header WITH ;
		Caption = "Codigo", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grdSas_ctiposeguro.Column1.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		SelectedBackColor = 247,223,187, ;
		SelectedForeColor = 0,64,128, ;
		Visible = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grdSas_ctiposeguro.Column2.Header1' AS header WITH ;
		Caption = "Nombre", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grdSas_ctiposeguro.Column2.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		SelectedBackColor = 247,223,187, ;
		SelectedForeColor = 0,64,128, ;
		Visible = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grdSas_ctiposeguro.Column3.Header1' AS header WITH ;
		Caption = "Generar", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grdSas_ctiposeguro.Column3.Tscheckbox1' AS tscheckbox WITH ;
		Alignment = 0, ;
		Caption = "", ;
		FontSize = 8, ;
		Left = 32, ;
		Name = "Tscheckbox1", ;
		ReadOnly = .F., ;
		Top = 23
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="checkbox" />

	ADD OBJECT 'grdSas_ctiposeguro.Column4.Header1' AS header WITH ;
		Caption = "Importe Actual", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grdSas_ctiposeguro.Column4.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		InputMask = "999,999,999", ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		SelectedBackColor = 247,223,187, ;
		SelectedForeColor = 0,64,128, ;
		Visible = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grdSas_ctiposeguro.Column5.Header1' AS header WITH ;
		Caption = "Deuda", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grdSas_ctiposeguro.Column5.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		SelectedBackColor = 247,223,187, ;
		SelectedForeColor = 0,64,128
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grdSas_ctiposeguro.Column6.Header1' AS header WITH ;
		Caption = "Total", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grdSas_ctiposeguro.Column6.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		SelectedBackColor = 247,223,187, ;
		SelectedForeColor = 0,64,128
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'hFecha' AS tstextbox WITH ;
		Alignment = 3, ;
		Left = 396, ;
		Name = "hFecha", ;
		TabIndex = 14, ;
		Top = 235, ;
		Value = ({  /  /  }), ;
		Width = 156
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'hFechaAlta' AS tstextbox WITH ;
		Alignment = 3, ;
		Height = 21, ;
		Left = 144, ;
		Name = "hFechaAlta", ;
		TabIndex = 15, ;
		Top = 257, ;
		Value = ({  /  /  }), ;
		Width = 156
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'hFechaBaja' AS tstextbox WITH ;
		Alignment = 3, ;
		Left = 396, ;
		Name = "hFechaBaja", ;
		TabIndex = 16, ;
		Top = 257, ;
		Value = ({  /  /  }), ;
		Width = 156
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'Idproducto1' AS idproducto WITH ;
		actualizar = .F., ;
		Left = 144, ;
		Name = "Idproducto1", ;
		objeto = this.parent.Producto, ;
		TabIndex = 2, ;
		Top = 37
		*< END OBJECT: ClassLib="..\libs\futura.vcx" BaseClass="textbox" />

	ADD OBJECT 'nom_vendedor' AS tstextbox WITH ;
		editable = .F., ;
		Enabled = .F., ;
		Height = 22, ;
		Left = 438, ;
		Name = "nom_vendedor", ;
		TabIndex = 28, ;
		Top = 84, ;
		Width = 114, ;
		ZOrderSet = 29
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'Olecontrol1' AS olecontrol WITH ;
		Height = 24, ;
		Left = 216, ;
		Name = "Olecontrol1", ;
		TabIndex = 50, ;
		Top = 291, ;
		Width = 324
		*< END OBJECT: BaseClass="olecontrol" OLEObject="c:\windows\syswow64\mscomctl.ocx" Value="0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABADN6kT9ABAwAAAEABAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABcAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAQAAAAAAAAABAAAAAIAAAD+/////v////7///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8iOgU1iYXREbFqAMDwKDYoIUM0EggAAAB9IQAAewIAAAGKq5cAAAYAHAAAAAAAAAAAAMhCAAAAAAHvzasAAAUAXAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAACQAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA5MzY4MjY1RS04NUZFLTExZDEtOEJFMy0wMDAwRjg3NTREQTEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAD//////////1zaGAAf3uy9AQAFAFzaGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==" />

	ADD OBJECT 'OpcionImpresion' AS tsoptiongroup WITH ;
		ButtonCount = 3, ;
		Height = 72, ;
		Left = 552, ;
		Name = "OpcionImpresion", ;
		TabIndex = 21, ;
		Top = 339, ;
		Width = 240, ;
		Option1.Caption = "Generar e Imprimir Factura", ;
		Option1.Height = 18, ;
		Option1.Left = 0, ;
		Option1.Name = "Option1", ;
		Option1.Top = 0, ;
		Option1.Width = 156, ;
		Option2.Caption = "Solo Generar Factura", ;
		Option2.Height = 18, ;
		Option2.Left = 0, ;
		Option2.Name = "Option2", ;
		Option2.Top = 24, ;
		Option2.Width = 144, ;
		Option3.Caption = "Solo Generar Compromisos", ;
		Option3.FontSize = 8, ;
		Option3.Height = 17, ;
		Option3.Left = 0, ;
		Option3.Name = "Option3", ;
		Option3.Top = 47, ;
		Option3.Value = 0, ;
		Option3.Width = 156
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="optiongroup" />

	ADD OBJECT 'Producto' AS tstextbox WITH ;
		ControlSource = "vt_emision.descripcion", ;
		Height = 21, ;
		Left = 144, ;
		MaxLength = 200, ;
		Name = "Producto", ;
		TabIndex = 3, ;
		Top = 62, ;
		Width = 408
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'Tipo' AS tsoptiongroup WITH ;
		Height = 24, ;
		Left = 144, ;
		Name = "Tipo", ;
		TabIndex = 10, ;
		Top = 181, ;
		Width = 156, ;
		Option1.Caption = "Fijos", ;
		Option1.Left = 5, ;
		Option1.Name = "Option1", ;
		Option1.Top = 5, ;
		Option2.Caption = "Variables", ;
		Option2.Left = 73, ;
		Option2.Name = "Option2", ;
		Option2.Top = 6
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="optiongroup" />

	ADD OBJECT 'Ts3dshape1' AS ts3dshape WITH ;
		Height = 2, ;
		Left = 566, ;
		Name = "Ts3dshape1", ;
		Top = 54, ;
		Width = 264
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="shape" />

	ADD OBJECT 'Tscommandbutton1' AS tscommandbutton WITH ;
		Caption = "Buscar", ;
		Left = 132, ;
		Name = "Tscommandbutton1", ;
		TabIndex = 19, ;
		Top = 291
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Tscommandbutton2' AS tscommandbutton WITH ;
		Caption = "Generar", ;
		Height = 26, ;
		Left = 552, ;
		Name = "Tscommandbutton2", ;
		TabIndex = 22, ;
		Top = 423, ;
		Width = 72
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Tslabel1' AS tslabel WITH ;
		Alignment = 0, ;
		Caption = "Datos de Emisión", ;
		Height = 22, ;
		Left = 564, ;
		Name = "Tslabel1", ;
		TabIndex = 35, ;
		Top = 36, ;
		Width = 125
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel10' AS tslabel WITH ;
		Caption = "Tipo de Servicio", ;
		Height = 22, ;
		Left = 24, ;
		Name = "Tslabel10", ;
		TabIndex = 33, ;
		Top = 183, ;
		Width = 113
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel11' AS tslabel WITH ;
		AutoSize = .T., ;
		Caption = "Fecha", ;
		Height = 16, ;
		Left = 103, ;
		Name = "Tslabel11", ;
		TabIndex = 24, ;
		Top = 13, ;
		Width = 34
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel12' AS tslabel WITH ;
		Caption = "Nro Contrato", ;
		Height = 16, ;
		Left = 60, ;
		Name = "Tslabel12", ;
		TabIndex = 46, ;
		Top = 134, ;
		Width = 77, ;
		ZOrderSet = 7
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel13' AS tslabel WITH ;
		Caption = "Nro Servicio", ;
		Height = 16, ;
		Left = 60, ;
		Name = "Tslabel13", ;
		TabIndex = 47, ;
		Top = 159, ;
		Width = 77, ;
		ZOrderSet = 7
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel14' AS tslabel WITH ;
		Alignment = 0, ;
		Caption = "Opciones", ;
		Height = 22, ;
		Left = 552, ;
		Name = "Tslabel14", ;
		TabIndex = 34, ;
		Top = 315, ;
		Width = 125
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel15' AS tslabel WITH ;
		Caption = "Total", ;
		Height = 16, ;
		Left = 264, ;
		Name = "Tslabel15", ;
		TabIndex = 48, ;
		Top = 549, ;
		Width = 77, ;
		ZOrderSet = 7
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel16' AS tslabel WITH ;
		Caption = "Hasta Fecha Alta", ;
		Height = 22, ;
		Left = 24, ;
		Name = "Tslabel16", ;
		TabIndex = 38, ;
		Top = 257, ;
		Width = 113
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel17' AS tslabel WITH ;
		Caption = "Hasta Fecha Baja", ;
		Height = 22, ;
		Left = 282, ;
		Name = "Tslabel17", ;
		TabIndex = 30, ;
		Top = 257, ;
		Width = 113
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel18' AS tslabel WITH ;
		Caption = "Mes", ;
		Height = 22, ;
		Left = 24, ;
		Name = "Tslabel18", ;
		TabIndex = 37, ;
		Top = 213, ;
		Width = 113
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel19' AS tslabel WITH ;
		Caption = "Año", ;
		Height = 22, ;
		Left = 283, ;
		Name = "Tslabel19", ;
		TabIndex = 32, ;
		Top = 213, ;
		Width = 113
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel2' AS tslabel WITH ;
		AutoSize = .T., ;
		Caption = "Producto o Servicio", ;
		Height = 16, ;
		Left = 28, ;
		Name = "Tslabel2", ;
		TabIndex = 29, ;
		Top = 37, ;
		Width = 109
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel20' AS tslabel WITH ;
		AutoSize = .T., ;
		Caption = "Id Emision", ;
		Height = 16, ;
		Left = 564, ;
		Name = "Tslabel20", ;
		TabIndex = 26, ;
		Top = 60, ;
		Width = 59
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel21' AS tslabel WITH ;
		AutoSize = .T., ;
		Caption = "Obs", ;
		Height = 16, ;
		Left = 564, ;
		Name = "Tslabel21", ;
		TabIndex = 25, ;
		Top = 84, ;
		Width = 24
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel3' AS tslabel WITH ;
		AutoSize = .T., ;
		Caption = "Descripcion", ;
		Height = 16, ;
		Left = 70, ;
		Name = "Tslabel3", ;
		TabIndex = 27, ;
		Top = 61, ;
		Width = 67
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel4' AS tslabel WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		Caption = "Ciclo Facturacion", ;
		Height = 16, ;
		Left = 42, ;
		Name = "Tslabel4", ;
		TabIndex = 40, ;
		Top = 109, ;
		Width = 95, ;
		ZOrderSet = 32
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel5' AS tslabel WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		Caption = "Cobrador", ;
		Height = 16, ;
		Left = 83, ;
		Name = "Tslabel5", ;
		TabIndex = 51, ;
		Top = 85, ;
		Width = 54, ;
		ZOrderSet = 32
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel6' AS tslabel WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		Caption = "Vendedor", ;
		Height = 16, ;
		Left = 338, ;
		Name = "Tslabel6", ;
		TabIndex = 49, ;
		Top = 85, ;
		Width = 57, ;
		ZOrderSet = 32
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel7' AS tslabel WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		Caption = "Tipo Cobertura", ;
		Height = 16, ;
		Left = 310, ;
		Name = "Tslabel7", ;
		TabIndex = 39, ;
		Top = 109, ;
		Width = 85, ;
		ZOrderSet = 32
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel8' AS tslabel WITH ;
		Caption = "Periodo del Servicio", ;
		Height = 22, ;
		Left = 24, ;
		Name = "Tslabel8", ;
		TabIndex = 36, ;
		Top = 235, ;
		Width = 113
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel9' AS tslabel WITH ;
		Caption = "Hasta", ;
		Height = 22, ;
		Left = 282, ;
		Name = "Tslabel9", ;
		TabIndex = 31, ;
		Top = 235, ;
		Width = 113
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tstextbox1' AS tstextbox WITH ;
		Alignment = 3, ;
		ControlSource = "vt_emision.fecha", ;
		Left = 144, ;
		Name = "Tstextbox1", ;
		TabIndex = 1, ;
		Top = 13, ;
		Value =
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'Tstextbox3' AS tstextbox WITH ;
		ControlSource = "vt_emision.obs", ;
		Height = 21, ;
		Left = 624, ;
		MaxLength = 200, ;
		Name = "Tstextbox3", ;
		TabIndex = 17, ;
		Top = 84, ;
		Width = 204
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtAño' AS tstextbox WITH ;
		Alignment = 3, ;
		ControlSource = "vt_emision.año", ;
		Left = 397, ;
		Name = "txtAño", ;
		TabIndex = 12, ;
		Top = 213, ;
		Value = (0), ;
		Width = 156
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtCantidad' AS tstextbox WITH ;
		Comment = "", ;
		ControlSource = "vt_emision.cantidad", ;
		editable = .F., ;
		Enabled = .F., ;
		Height = 22, ;
		Left = 360, ;
		MaxLength = 50, ;
		Name = "txtCantidad", ;
		requerido = .F., ;
		TabIndex = 44, ;
		Top = 547, ;
		Width = 48, ;
		ZOrderSet = 6
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtIdEmision' AS tstextbox WITH ;
		ControlSource = "vt_emision.idemision", ;
		Height = 21, ;
		Left = 624, ;
		MaxLength = 0, ;
		Name = "txtIdEmision", ;
		ReadOnly = .T., ;
		TabIndex = 18, ;
		Top = 60, ;
		Width = 72
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtMes' AS tsspinner WITH ;
		ControlSource = "vt_emision.mes", ;
		editable = .T., ;
		Height = 24, ;
		Left = 145, ;
		Name = "txtMes", ;
		SpinnerHighValue = 12.00, ;
		SpinnerLowValue = 1.00, ;
		TabIndex = 11, ;
		Top = 210, ;
		Width = 155
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="spinner" />

	ADD OBJECT 'txtNroContrato' AS campo_clave WITH ;
		actualizar = .T., ;
		condicionextra = c.IdEmpresa=?oApp.Empresa, ;
		condicion_en_edicion = IdEstado = 'A', ;
		ControlSource = "", ;
		copiarcampos = DireccionServicio as DireccionRef, ;
		datoayuda = Contratos  Activos, ;
		Height = 23, ;
		indice = NroContrato, ;
		Left = 144, ;
		MaxLength = 20, ;
		Name = "txtNroContrato", ;
		objeto = this.parent.Contrato, ;
		objeto2 = , ;
		origen = R, ;
		pegarcampos = DireccionRef, ;
		retorna = c.Nombre, ;
		retorna2 = , ;
		TabIndex = 8, ;
		tabla = sas_Contrato c, ;
		Top = 132, ;
		Width = 72
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtNroServicio' AS campo_clave WITH ;
		actualizar = .T., ;
		condicionextra = c.IdEmpresa=?oApp.Empresa, ;
		condicion_en_edicion = Estado = 'D', ;
		ControlSource = "", ;
		copiarcampos = , ;
		datoayuda = , ;
		Height = 23, ;
		indice = NroSolicitud, ;
		InputMask = "99999999", ;
		Left = 144, ;
		Name = "txtNroServicio", ;
		objeto = this.parent.txtPaciente, ;
		objeto2 = , ;
		origen = R, ;
		pegarcampos = , ;
		retorna = c.Paciente, ;
		retorna2 = , ;
		TabIndex = 9, ;
		tabla = sas_servicios c, ;
		Top = 157, ;
		Width = 72
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtPaciente' AS tstextbox WITH ;
		Comment = "", ;
		editable = .F., ;
		Enabled = .F., ;
		Height = 22, ;
		Left = 218, ;
		MaxLength = 50, ;
		Name = "txtPaciente", ;
		requerido = .T., ;
		TabIndex = 43, ;
		Top = 158, ;
		Width = 334, ;
		ZOrderSet = 6
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtTotales' AS tstextbox WITH ;
		Comment = "", ;
		ControlSource = "vt_emision.importe", ;
		editable = .F., ;
		Enabled = .F., ;
		Height = 22, ;
		InputMask = "999,999,999,999", ;
		Left = 408, ;
		MaxLength = 50, ;
		Name = "txtTotales", ;
		requerido = .F., ;
		TabIndex = 45, ;
		Top = 547, ;
		Width = 130, ;
		ZOrderSet = 6
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />
	
	PROCEDURE afteraddnew
		*ThisForm.cbocobrador1.Value='-1'
		thisform.cboCiclo.Value='-1'
		thisform.cboTipo.Value='-1'
		*thisform.cbovendedor1.Value='-1'
	ENDPROC

	PROCEDURE imprimir
		LPARAMETERS lcIdFactura
		M.IDFACTURA = lcIdFactura 
		
		
		*Verificamos la forma de imprimir la factura
		*Si tiene nombre formato, se usa el report
		*Si no tiene, se usa ASCII
		=THIS.RUNSQL("Select convert(CHAR(50),dbo.LeerConstante(?oApp.Empresa,'VT_NOMBREFORMATO_FACT')) as NombreFormato", 'cTipo')
		IF RECCOUNT('cTipo')=0
		 MESSAGEBOX("No se encuentra la constante VT_NOMBREFORMATO_FACT")
			RETURN
		ENDIF
		
		IF !EMPTY(NVL(cTipo.NombreFormato,''))
			cTipoImpresion='R'		&&Report
		ELSE
			cTipoImpresion='A'		&&Ascii
		ENDIF
		
		
			IF cTipoImpresion='A'
				=THIS.RUNSQL("Select convert(int,dbo.LeerConstante(?oApp.Empresa,'VT_IDFORMATOTPV')) as IdFormato", 'cConfig')
				IF RECCOUNT('cConfig')=0
				 MESSAGEBOX("No se encuentra la constante VT_IDFORMATOTPV")
					RETURN
				ENDIF
					=ImpresionFactura(cConfig.Idformato)
			ELSE
				LCDESTINO = LEERINI('Destino Impresion', 'OPCIONES')
				If Empty(LCDESTINO)
					LCDESTINO = 'PREVIEW NOCONSOLE'
					= ESCRIBIRINI(LCDESTINO, 'Destino Impresion', 'OPCIONES')
				Endif
		
				REPORT FORM (cTipo.NombreFormato)  &LCDESTINO 
			ENDIF
							
	ENDPROC

	PROCEDURE grdSas_ctiposeguro.Column3.Header1.Click
		IF EMPTY(THIS.TAG)
			THIS.TAG = 'OK'
			REPLACE generar WITH .T. ALL IN sas_cContratos
		ELSE
			THIS.TAG = ''
			REPLACE generar WITH .F. ALL IN sas_cContratos
		ENDIF
	ENDPROC

	PROCEDURE grdSas_ctiposeguro.Refresh
		IF thisform.editmode
			this.sumcolumn()
		
			this.Parent.txttotales.Value=this.totales(1)+this.totales(2)
			CALCULATE COUNT() TO lnCantidad IN sas_cContratos 
		
			this.Parent.txtCantidad.Value=lnCantidad 
		ENDIF
		
	ENDPROC

	PROCEDURE Tipo.InteractiveChange
		this.Refresh()
	ENDPROC

	PROCEDURE Tipo.Refresh
		IF this.Value=1
			this.Parent.txtAño.Enabled=.t.
			this.Parent.txtmes.Enabled=.t.
			this.Parent.dfecha.Enabled=.f.
			this.Parent.hfecha.Enabled=.f.
		
		ELSE
			this.Parent.txtAño.Enabled=.f.
			this.Parent.txtmes.Enabled=.f.
			this.Parent.dfecha.Enabled=.t.
			this.Parent.hfecha.Enabled=.t.
		ENDIF
			
	ENDPROC

	PROCEDURE Tscommandbutton1.Click
		m.Cobrador = ThisForm.cbocobrador1.Value
		m.Ciclo  = thisform.cboCiclo.Value
		m.IdTipoCobertura = thisform.cboTipo.Value
		m.IdVendedor = thisform.cbovendedor1.Value
		
		IF EMPTY(m.IdVendedor)
			m.IdVendedor='-1'
		ENDIF
		
		IF EMPTY(m.Cobrador)
			m.Cobrador ='-1'
		ENDIF
		
		
		IF EMPTY(ThisForm.txtNroContrato.Value)
			m.NroContrato='.'
		ELSE
			m.NroContrato=ThisForm.txtNroContrato.Value
		ENDIF 
		
		IF EMPTY(ThisForm.txtNroServicio.Value)
			m.NroServicio='.'
		ELSE
			m.NroServicio=ThisForm.txtNroServicio.Value
		ENDIF 
		
		m.hFechaAlta= thisform.hfechaAlta.Value
		m.Mes = thisform.txtmes.Value
		m.Año = thisform.txtAño.Value
		m.hFechaBaja= thisform.hfechaBaja.Value
		
		
		*=REQUERY('sas_cContratos')
		IF ThisForm.Tipo.Value=1
			cmdSQL = " exec dbo.sas_TraerCompromiso ?oApp.Empresa,?m.Ciclo,?m.Cobrador,?m.IdVendedor,?m.IdTipoCobertura, ?m.NroContrato, ?m.hFechaAlta, ?m.Mes, ?m.Año,?m.hFechaBaja"
			
		*!*		TEXT TO cmdSQL noshow
		*!*			SELECT Sas_contrato.NroContrato, Sas_contrato.IdCliente, (Sas_contrato.Importe) + ISNULL(SUM(c1.Importe),0) as Importe, Vt_clientes.RazSocial, Sas_contrato.IdCiclo, Convert(bit,1) as Generar 
		*!*			FROM  dbo.sas_Contrato Sas_contrato  
		*!*			INNER JOIN dbo.vt_clientes Vt_clientes  
		*!*			ON  Sas_contrato.IdEmpresa = Vt_clientes.IdEmpresa AND  Sas_contrato.IdCliente = Vt_clientes.IdCliente
		*!*			 left join sas_contrato c1 on Sas_contrato.idempresa=c1.idempresa and Sas_contrato.NroContrato = c1.IdGrupoFactura
		*!*			 AND  c1.IdEstado = 'A' and  (c1.IdCiclo =  ?m.Ciclo or ?m.Ciclo='-1')
		*!*			WHERE (  Sas_contrato.IdEmpresa =  ?oApp.Empresa 
		*!*			AND  Sas_contrato.IdEstado = 'A'   
		*!*			and  (Sas_contrato.IdCobrador =  ?m.Cobrador  or ?m.Cobrador='-1')
		*!*			and  (Sas_contrato.IdCiclo =  ?m.Ciclo or ?m.Ciclo='-1') 
		*!*			and  (Sas_contrato.IdVendedor =  ?m.IdVendedor or ?m.IdVendedor='-1') 
		*!*			and  (Sas_contrato.IdTipoCobertura =  ?m.IdTipoCobertura or ?m.IdTipoCobertura='-1') 
		*!*			and  (Sas_contrato.NroContrato =  ?m.NroContrato or ?m.NroContrato='.') )
		*!*			and (sas_Contrato.Fecha <= ?m.hFechaAlta) 
		*!*			and isnull(Sas_contrato.IdGrupoFactura,'')=''
		*!*	   		and (Sas_contrato.Importe) + ISNULL(c1.Importe,0)>0
		*!*	   		GROUP BY Sas_contrato.NroContrato, Sas_contrato.IdCliente,Sas_contrato.Importe,Vt_clientes.RazSocial, Sas_contrato.IdCiclo
		*!*			ORDER BY Sas_contrato.NroContrato
		
		*!*		ENDTEXT
			
		ELSE
			TEXT TO cmdSQL noshow  
				SELECT Sas_contrato.NroContrato, Sas_contrato.IdCliente, Sas_contrato.Importe, Vt_clientes.RazSocial, Sas_contrato.IdCiclo, Convert(bit,1) as Generar 
				FROM  dbo.sas_Contrato Sas_contrato  
				INNER JOIN dbo.vt_clientes Vt_clientes  
				ON  Sas_contrato.IdEmpresa = Vt_clientes.IdEmpresa AND  Sas_contrato.IdCliente = Vt_clientes.IdCliente 
				WHERE   Sas_contrato.IdEmpresa =  ?oApp.Empresa 
				AND  Sas_contrato.IdEstado = 'A'   
				and  (Sas_contrato.IdCobrador =  ?m.Cobrador  or ?m.Cobrador='-1')
				and  (Sas_contrato.IdCiclo =  ?m.Ciclo or ?m.Ciclo='-1') 
				and  (Sas_contrato.IdVendedor =  ?m.IdVendedor or ?m.IdVendedor='-1') 
				and  (Sas_contrato.IdTipoCobertura =  ?m.IdTipoCobertura or ?m.IdTipoCobertura='-1')
				and  (Sas_contrato.NroContrato=  ?m.NroContrato or ?m.NroContrato='.') 
				ORDER BY Sas_contrato.NroContrato		
			ENDTEXT
		ENDIF
		
		
		thisform.grdSas_ctiposeguro.Recordsource=''
		
		thisform.runsql(cmdSQL,'sas_cContratos')
		
		**VG 25/05/2011
		**Si es variable calcular el Importe Final
		thisform.olecontrol1.value = 0
		IF ThisForm.Tipo.Value=2
				thisform.olecontrol1.max=RECCOUNT('sas_cContratos')+1
				
				SELECT sas_cContratos
				SCAN
					thisform.olecontrol1.value = thisform.olecontrol1.value + 1 
					TEXT TO cmdSQL NOSHOW 
					SELECT     s.NroContrato, sd.IdProducto, SUM(sd.Cantidad) AS Total, cb.Cantidad, cb.Precio
						FROM         sas_Cobertura AS cb INNER JOIN
		                      sas_Contrato AS c ON cb.IdContrato = c.IdContrato RIGHT OUTER JOIN
		                      sas_Servicios AS s INNER JOIN
		                      st_movimiento_Det AS sd ON s.IdRemision = sd.IdRemision ON cb.IdProducto = sd.IdProducto AND c.NroContrato = s.NroContrato
		                WHERE c.IdEmpresa =  ?oApp.Empresa 
		                AND convert(datetime,CONVERT(VARCHAR (10),S.fechaAgenda,105)) between ?ThisForm.dFecha.Value and ?ThisForm.hFecha.value
		                AND c.NroContrato = ?sas_cContratos.NroContrato
		                and (s.NroSolicitud = ?m.NroServicio or ?m.NroServicio='.')       
						GROUP BY s.NroContrato, sd.IdProducto, cb.Cantidad, cb.Precio
					ENDTEXT
					thisform.runsql(cmdSQL,'cDet')
					SELECT cDet
					m.Total = 0
					SCAN
						IF cDet.Total>NVL(cDet.Cantidad,0)
							m.Total = m.Total + (cDet.Total-NVL(cDet.Cantidad,0))*cDet.Precio
						ENDIF 
					ENDSCAN
					SELECT sas_cContratos
					replace Importe WITH m.Total
					 
				ENDSCAN
				SELECT sas_cContratos
				DELETE FOR Importe=0
		
		ENDIF
		
		
		thisform.grdSas_ctiposeguro.Recordsource='sas_cContratos'
		ThisForm.grdSas_ctiposeguro.Column1.ControlSource='sas_cContratos.NroContrato'
		ThisForm.grdSas_ctiposeguro.Column2.ControlSource='sas_cContratos.RazSocial'
		ThisForm.grdSas_ctiposeguro.Column3.ControlSource='sas_cContratos.Generar'
		ThisForm.grdSas_ctiposeguro.Column4.ControlSource='sas_cContratos.Importe'
		ThisForm.grdSas_ctiposeguro.Column5.ControlSource='sas_cContratos.Deuda'
		ThisForm.grdSas_ctiposeguro.Column6.ControlSource='sas_cContratos.Importe+sas_cContratos.Deuda'
		thisform.grdSas_ctiposeguro.Refresh()
		
	ENDPROC

	PROCEDURE Tscommandbutton2.Click
		SELECT sas_cContratos
		IF EMPTY(ThisForm.Tstextbox1.Value)
			MESSAGEBOX("Indique la fecha de la factura",64,TASTRADE_LOC)
			RETURN 
		ENDIF
		IF EMPTY(ThisForm.IDproducto1.Value)
			MESSAGEBOX("Indique el producto a facturar",64,TASTRADE_LOC)
			RETURN 
		ENDIF
		
			
		
		SCAN FOR !EMPTY(NVL(Importe,0)) AND generar=.t.
		
			***Generar Compromisos
			IF this.Parent.opcionImpresion.Value=3
				thisform.runsql("exec [sas_GenerarCompromiso] ?oApp.Empresa, ?IdCliente,?ThisForm.Tstextbox1.value, '0001',?Importe,?ThisForm.Idproducto1.Value, ?ThisForm.Producto.value,?NroContrato,?IdCiclo,?ThisForm.txtMes.value,?ThisForm.txtAño.value,?thisform.txtIdEmision.value","cResult")
				
			ELSE
				***Generar Facturas
				thisform.runsql("exec [sas_FacturaServicio] ?oApp.Empresa, ?IdCliente,?ThisForm.Tstextbox1.value, '0001',?Importe,?ThisForm.Idproducto1.Value, ?ThisForm.Producto.value,?NroContrato,?IdCiclo,?ThisForm.txtMes.value,?ThisForm.txtAño.value,?thisform.txtIdEmision.value","cResult")
				
				***Imprimir Facturas
				IF this.Parent.opcionImpresion.Value=1
					thisform.imprimir(cResult.IdFactura)
				ENDIF
				
			ENDIF
				
		ENDSCAN
		
		MESSAGEBOX("Proceso Finalizado.",64,TASTRADE_LOC)
		
		
		
		*!*	Create  Proc [dbo].[sas_FacturaServicio]
		*!*	(@IdEmpresa char(3), @IdCliente char(10),@Fecha datetime, @Usuario char(10), @Importe money, 
		*!*	@IdProducto char(20))
		
		
	ENDPROC

	PROCEDURE txtNroContrato.LostFocus
		
		
	ENDPROC

	PROCEDURE txtNroServicio.LostFocus
		
		
	ENDPROC

ENDDEFINE
